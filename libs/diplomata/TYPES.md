# Types

Since the underlying El-Gamal cryptosystem is elliptic, group elements
are modeled as pairs of integers:

```
[<int>, <int>]
```

Consequently, a decisional Diffie-Hellman (DDH) tuple is modeled by

### `ddh`
```
ddh [
    [<int>, <int>], 
    [<int>, <int>], 
    [<int>, <int>]
]
```

whereas a (non-interactive) Chaum-Pedersen proof is modeled by

### `chaum-pedersen`
```
chaum-pedersen {
    u_comm: [<int>, <int>],
    v_comm: [<int>, <int>],
    s: <int>,
    d: [<int>, <int>]
}
```

The pair of a DDH along with an acclaimed Chaum-Pedersen proof 
of knowledge is modeled by

### `ddh-proof`
```
ddh-proof {
    ddh: <ddh>.
    proof: <chaum-pedersen>
}
```

In the Diplomata protocol, two keys are needed: one El-Gamal key ("ecc") for
commiting, signing etc., and one NaCl key ("nacl") for 
symmetric encryption. These are organized in the following 
extended key structure:

### `key`
```
key {
    ecc: {
        x: <int>,
        y: <int>,
        d: <int>
    },
    nacl: <str(hex)>
}
```
Proposed:
```
{
  private: [ecc.x, ecc.y, ecc.d, nacl.priv],
  public: [ecc.x, ecc.y, nacl.pub]
}
```
Their public counterparts are organized in the following structure, serving
also as public identity in the protocol context:

### `pub`
```
pub {
    ecc: [<int>, <int>],
    nacl: <str(hex)>
}
```

Commitments, occuring as El-Gamal ciphers (i.e., pairs of group elements), are
modeled by the following structure:

### `comm`
```
comm {
    c1: [<int>, <int>],
    c2: [<int>, <int>]
}
```

The proof generated by an issuer is modeled as follows:

### `proof`
```
proof {
    c_r: <comm>,
    decryptor: <str(hex)>,
    nirenc: {
        proof_c1: <ddh-proof>,
        proof_c2: <ddh-proof>
    },
    niddh: <str(hex)>
}
```
