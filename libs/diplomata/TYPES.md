# Types

Since the underlying El-Gamal cryptosystem is elliptic, group elements
are modeled as pairs of integers:

```
[<int>, <int>]
```

### `ddh`

A decisional Diffie-Hellman (DDH) tuple is modeled by

```
ddh [
    [<int>, <int>], 
    [<int>, <int>], 
    [<int>, <int>]
]
```

### `chaum-pedersen`

A (non-interactive) Chaum-Pedersen proof is modeled by

```
chaum-pedersen {
    g_comm: [<int>, <int>],
    u_comm: [<int>, <int>],
    challene: <int>,
    response: <int>,
}
```

### `ddh-proof`

The pair of a DDH along with an acclaimed Chaum-Pedersen proof 
of knowledge is modeled by

```
ddh-proof {
    ddh: <ddh>.
    proof: <chaum-pedersen>
}
```

### `key`

In the Diplomata protocol, two keys are needed: one El-Gamal key ("ecc") for
commiting, signing etc., and one NaCl key ("nacl") for 
symmetric encryption. These are organized in the following 
extended key structure:

```
key {
    ecc: {
        x: <int>,
        y: <int>,
        d: <int>
    },
    nacl: <str(hex)>
}
```

The flattened version reads:

```
[
    <int>,
    <int>,
    <int>,
    <str(hex)>
]
```

### `pub`

Their public counterparts are organized in the following structure, serving
also as public identity in the protocol context:

```
pub {
    ecc: [<int>, <int>],
    nacl: <str(hex)>
}
```

The flattened version reads:

```
[
    <int>,
    <int>,
    <str(hex)>
]
```

### `comm`

Commitments, occuring as El-Gamal ciphers (i.e., pairs of group elements), are
modeled by the following structure:

```
comm {
    c1: [<int>, <int>],
    c2: [<int>, <int>]
}
```

### `proof`

The proof generated by an issuer is modeled as follows:

```
proof {
    c_r: <comm>,
    decryptor: <str(hex)>,
    nirenc: <ddh-proof>,
    niddh: <str(hex)>
}
```
